
@{
    ViewBag.Title = "Mapa_admin";
    Layout = "~/Views/Shared/IndexBackEndMaster.cshtml";
}


@section Sideusu{
    <div class="collapse" id="collapseExample">
        <ul class="nav">
            <li class="active">
                <a href="~/VBackend/PerfilAdmin">
                    <span class="sidebar-mini">EP</span>
                    <span class="sidebar-normal">Editar Perfil</span>
                </a>
            </li>
        </ul>
    </div>
}



@section SideBar{
    <li>
        <a href="~/VBackend/estadisticas">
            <i class="pe-7s-global"></i>
            <p>Inicio</p>
        </a>
    </li>
    <li class="active">


        <a href="~/VBackend/Mapa_admin">
            <i class="pe-7s-map-2"></i>
            <p>Mapa</p>
        </a>
    </li>
    <li>
        <a data-toggle="collapse" href="#tablesExamples">
            <i class="pe-7s-map-marker"></i>
            <p>
                Gestion de Puntos
                <b class="caret"></b>
            </p>
        </a>
        <div class="collapse" id="tablesExamples">
            <ul class="nav">
                <li>
                    <a href="~/VBackend/ListaDePuntosM">
                        <span class="sidebar-mini"><i class="pe-7s-like2"></i></span>
                        <span class="sidebar-normal">Aprobar Puntos</span>
                    </a>
                </li>
                <li>
                    <a href="~/VBackend/PuntosAprovados">
                        <span class="sidebar-mini"><i class="pe-7s-check"></i></span>
                        <span class="sidebar-normal">Puntos Aprobados</span>
                    </a>
                </li>
                <li>
                    <a href="~/VBackend/PuntosD">
                        <span class="sidebar-mini"><i class="pe-7s-junk"></i></span>
                        <span class="sidebar-normal">Puntos desaprobados</span>
                    </a>
                </li>
                @*<li>
                    <a href="~/VBackend/tiposdepeligro">
                        <span class="sidebar-mini"><i class="pe-7s-map"></i></span>
                        <span class="sidebar-normal">Tipos De delitos</span>
                    </a>
                </li>*@

            </ul>
        </div>
    </li>
    <li>
        <a data-toggle="collapse" href="#tablesExamples1">
            <i class="pe-7s-config"></i>
            <p>
                Configuración
                <b class="caret"></b>
            </p>
        </a>
        <div class="collapse" id="tablesExamples1">
            <ul class="nav">

                <li>
                    <a href="~/VBackend/ConfiguracionIndex">
                        <span class="sidebar-mini"><i class="pe-7s-home"></i></span>
                        <span class="sidebar-normal">Index</span>
                    </a>
                </li>
             

                @*<li>
                    <a href="~/VBackend/Backud">
                        <span class="sidebar-mini"><i class="pe-7s-server"></i></span>
                        <span class="sidebar-normal">Backup</span>
                    </a>
                </li>*@

            </ul>
        </div>
    </li>
    @*<li>
            <a data-toggle="collapse" href="#tablesExamples2">
                <i class="pe-7s-mail"></i>
                <p>
                    Mensajeria
                    <b class="caret"></b>
                </p>
            </a>
            <div class="collapse" id="tablesExamples2">
                <ul class="nav">

                    <li>
                        <a href="~/VBackend/mensajes">
                            <span class="sidebar-mini"><i class="pe-7s-mail-open-file"></i></span>
                            <span class="sidebar-normal">Mensajes</span>
                        </a>
                    </li>
                    <li>
                        <a href="~/VBackend/buzon_de_sugerencias">
                            <span class="sidebar-mini"><i class="pe-7s-portfolio"></i></span>
                            <span class="sidebar-normal">Buzón de Sugerencias</span>
                        </a>
                    </li>


                </ul>
            </div>
        </li>*@
    <li>
        <a data-toggle="collapse" href="#tablesExamples3">
            <i class="pe-7s-graph2"></i>
            <p>
                Reportes
                <b class="caret"></b>
            </p>
        </a>
        <div class="collapse" id="tablesExamples3">
            <ul class="nav">

                <li>
                    <a href="~/VBackend/Reporte_peligros">
                        <span class="sidebar-mini"><i class="pe-7s-graph1"></i></span>
                        <span class="sidebar-normal">Reporte de peligros </span>
                    </a>
                </li>
                <li>
                    <a href="~/VBackend/reporte_usuarios">
                        <span class="sidebar-mini"><i class="pe-7s-portfolio"></i></span>
                        <span class="sidebar-normal">Reporte de usuarios</span>
                    </a>
                </li>


            </ul>
        </div>
    </li>

}

<link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
@*<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>*@
<script type="text/javascript" src='https://maps.google.com/maps/api/js?sensor=false&libraries=places&key=AIzaSyCuiUJxL3eVPwCyGdf1P6g9TUQ4KW95YtA'></script>

<div id="map_canvas" style="width:100%; height:680px "></div>
<div id="legend"></div>

<script type="text/javascript">

    var markers;

    $.ajax({
        url: "/usuariofron/devolverpuntos",
        success: function (data) {
            var array = []
            for (var i = 0; i < data.length; i++) {
                array.push([data[i]["punton"], data[i]["x"], data[i]["y"], data[i]["id"]])
            }
            markers = array;

            initializeMaps();
        }

    })
    var image = {
        url: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
        // This marker is 20 pixels wide by 32 pixels high.
        size: new google.maps.Size(40, 52),
        // The origin for this image is (0, 0).
        origin: new google.maps.Point(0, 0),
        // The anchor for this image is the base of the flagpole at (0, 32).
        anchor: new google.maps.Point(0, 32)
    };

    function initializeMaps() {
        var myOptions = {
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        var infowindow = new google.maps.InfoWindow();
        var marker, i;
        var bounds = new google.maps.LatLngBounds();
        var icons = {
            i1: {
                name: 'BACHES',
                icon: '../puntosimg/42.png'

            },
            i2: {
                name: 'MALTRATO ANIMAL',
                icon: "../puntosimg/52.png"

            },
            i3: {
                name: 'LOTES BALDÍOS',
                icon: "../puntosimg/62.png"
            },
            i4: {
                name: 'VANDALISMO ',
                icon: "../puntosimg/72.png"
            },
            i5: {
                name: 'ROBO',
                icon: "../puntosimg/82.png"
            },
            i6: {
                name: 'QUEMA DE BASURA',
                icon: "../puntosimg/92.png"
            },
            i7: {
                name: 'ACCIDENTES AUTOMOVILÍSTICOS',
                icon: "../puntosimg/102.png"
            },
            i8: {
                name: 'OTROS',
                icon: "../puntosimg/112.png"
            }
           
        };

        for (i = 0; i < markers.length; i++) {
            if (markers[i][3] == 11)
                //robo
            {
                image = "../puntosimg/112.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 4)//asalto de auto
            {
                image = "../puntosimg/42.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 5) {//asaldo de casa
                image = "../puntosimg/52.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 6) {//asalro de comercio
                image = "../puntosimg/62.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 7) {//asalro de persona
                image = "../puntosimg/72.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 8) {//actividad sospechopsa
                image = "../puntosimg/82.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 9) {//homicidio
                image = "../puntosimg/92.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            else if (markers[i][3] == 10) {//vandalismo
                image = "../puntosimg/102.png";
                var pos = new google.maps.LatLng(markers[i][1], markers[i][2]);
                bounds.extend(pos);
                marker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: image
                });
            }
            google.maps.event.addListener(marker, 'click', (function (marker, i) {
                return function () {
                    infowindow.setContent(markers[i][0]);
                    infowindow.open(map, marker);
                }
            })(marker, i));
        }
        map.fitBounds(bounds);
        var legend = document.getElementById('legend');
        for (var key in icons) {
            var type = icons[key];
            var name = type.name;
            var icon = type.icon;
            var div = document.createElement('div');
            div.innerHTML = '<br/><img src="' + icon + '"> ' + name;
            legend.appendChild(div);
        }

        map.controls[google.maps.ControlPosition.RIGHT_CENTER].push(document.getElementById('legend'));
    }


</script>
